<div class="container mt-3">
  <div class="d-flex">
    <div class="card-owner-infos-wrapper">
      <div class="card-owner-infos m-5">
        <%= link_to user_path(@activity.owner_id) do %>
          <%= cl_image_tag @activity.owner.photo.key, class: "avatar-show-large", alt: "avatar-show-large" %>
        <% end %>
        <div class="card-owner-infos-bio mt-3">
          <h5>About <%= @activity.owner.first_name %> <%= @activity.owner.last_name %> </h5>
          <p><%= @activity.owner.bio %></p>
        </div>

        <div class="card-owner-grid">
            <p class="card-owner-infos-details"><i class="fas fa-laptop-house"></i> <br> <%= @activity.owner.company %></p>
            <p class="card-owner-infos-details"><i class="fas fa-briefcase"></i> <br> <%= @activity.owner.industry %></p>
            <p class="card-owner-infos-details"><i class="fas fa-address-card"></i> <br> <%= @activity.owner.job_title %></p>
            <p class="card-owner-infos-details"><i class="fas fa-globe"></i> <br> <%= @activity.owner.country %></p>
        </div>

        <div class="d-flex justify-content-between">
          <div class="card-owner-infos-past">
            <p>Participated ðŸš€</p>
            <strong><%= @activity.owner.activities.length  %></strong>
          </div>
          <div class="card-owner-infos-past">
            <p>Organized ðŸš€</p>
            <strong><%= @activity.length %></strong>
          </div>
        </div>
      </div>
      <div>
        <%= link_to user_path(@activity.owner) do %>
          <p class="me-4 text-end view-profile"><i class="far fa-eye"></i> View <%= @activity.owner.first_name %>'s full profile</p>
        <% end %>
      </div>
    </div>





    <div class="card-activity-description-wrapper">
      <div class="card-activity-description">
        <img src="<%= cl_image_path @activity.photo.key %>" />
        <div class="d-flex flex-column", style="flex-grow: 1; height: 100%;">
          <div class="card-activity-description-infos">
            <div>
              <h2 id='activity-name'><%= @activity.name %></h2>
              <p class="mt-2"><%= @activity.description %></p>
              <div class="d-flex">
                <div class="card-activity-description-date me-4"><i class="far fa-calendar-alt"></i>
                  <span id="activity-date"><%= @activity.start_date.strftime("%A %B %e") %></span>
                </div>

                <div class="card-activity-description-date"><i class="fas fa-map-marked-alt"></i>
                  <%= @activity.place %>
                </div>
              </div>
              <div class="d-flex justify-content-end mt-5 me-3">
                <div class="hosting-btn" data-controller="sweetalert">
                  <%if @activity.users.include?(current_user) %>
                    <p id="already_in">You are registered for this activity!</p>
                    <div class="d-flex justify-content-center">
                      <div>
                        <div id="find-other-activity"><%= link_to "Find Another Activity", activities_path, id:"find-other-activity" %></div>
                        <p><button id="sweet-cancel">Cancel your booking</button></p>
                      </div>
                    </div>
                    <%= link_to "Cancel Booking",activity_booking_path(@activity, @booking_exist), method: :delete, class: "hidden cancel-btn" unless current_user == @activity.owner %>
                  <% elsif policy(@activity).create? && @all_participants.count < @activity.capacity_max %>
                    <% unless current_user == @activity.owner  %>
                      <div id="registration">Count me in!</div>
                      <%= link_to "", activity_bookings_path(@activity), method: :post, class: "hidden registration_hidden_btn" %>
                    <% end %>
                  <% else %>
                    <p id="sorry_full">Sorry, Activity full!</p>
                    <%= link_to "Find Another Activity", activities_path, class: "btn btn-gradient" %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>




<div class="container mt-4">
  <div class="show_bottom_page">
    <h3><%=pluralize(@all_participants.count, "registered participant")%> for this event  (Max <%= @activity.capacity_max%>) </h3>
    </div>
    <div data-controller="scroll">
      <div class="card-participants">
        <% @all_participants.first(6).each do |user| %>
          <div class="card-participants-infos">
          <%= link_to user_path(user) do %>
            <%= cl_image_tag user.photo.key, class: "avatar-show", alt: "avatar-show" %>
          <% end %>
            <h2><%= user.first_name %> <%= user.last_name %></h2>
            <p><i class="fas fa-laptop-house"> </i><%= user.company %></p>
          </div>
        <% end %>
      </div>
      <% if @all_participants.length > 6%>
        <div class="left-participants left-participants-hidden" data-scroll-target="listhide">
          <div class="left-participants-info">
            <% @all_participants.last(@all_participants.length - 6).each do |user| %>
              <div class="card-participants-infos">
                <%= link_to user_path(user) do %>
                  <%= cl_image_tag user.photo.key, class: "avatar-show", alt: "avatar-show" %>
                <% end %>
                <h2><%= user.first_name %> <%= user.last_name %></h2>
                <p><i class="fas fa-laptop-house"> </i><%= user.company %></p>
              </div>
            <% end %>
          </div>
        </div>
        <button id="more" data-scroll-target="test" data-action="click->scroll#toggleList"> View More </button>
      <% end %>
    </div>
  </div>
</div>
